
#    $ mv payment-main payment
#    Install the dependencies
#  # cd /home/roboshop/payment
#  # pip3 install -r requirements.txt
#  Note: Above command may fail with permission denied, So run as root user
#
#    Update the roboshop user and group id in payment.ini file.
#
#    Setup the service
#
#  # mv /home/roboshop/payment/systemd.service /etc/systemd/system/payment.service
#  # systemctl daemon-reload
#  # systemctl enable payment
#  # systemctl start payment

- name: Install python3
  yum:
    name:
      - python36
      - gcc
      - python3-devel
    state: installed

- name: Create Roboshop user
  user:
    name: roboshop
  register: uout

- name: Download from Github
  include_role:
    name: common
    tasks_from: download-github

- name: Install specified python requirements
  pip:
    requirements: /home/roboshop/{{COMPONENT}}/requirements.txt
    executable: pip3

- name: debug
  debug:
    msg: "{{uout}}"

- name: Update User Info
  lineinfile:
    path: /home/roboshop/{{COMPONENT}}/payment.ini
    regexp: '^gid'
    line: "uid = {{uout.group}}"



